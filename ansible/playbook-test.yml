---
- hosts: all
  become: false
  roles:
    - basics
    - test
  vars:
  - images:
    - name: "gondul-db-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" ]
      links: []
      ports: []
    - name: "gondul-graphite-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" , "{{ pwd.stdout }}/data/graphite:/var/lib/graphite" ]
      links: []
      ports: []
    - name: "gondul-grafana-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" , "{{ pwd.stdout }}/data/grafana:/var/lib/grafana" ]
      links: ["gondul-graphite-test:graphite" ]
      ports: []
    - name: "gondul-collector-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" ]
      links: [ "gondul-db-test:db", "gondul-graphite-test:graphite" ]
      ports: []
    - name: "gondul-front-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" ]
      links: [ "gondul-db-test:db" ]
      ports: "{{ front_ports }}"
    - name: "gondul-templating-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" ]
      links: [ "gondul-front-test:gondul-front"]
      ports: []
    - name: "gondul-varnish-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" ]
      links: [ "gondul-front-test:gondul-front", "gondul-graphite-test:gondul-graphite", "gondul-templating-test:gondul-templating" ]
      ports: "{{ varnish_ports }}"
    - name: "gondul-snmp-test"
      volumes: [ "{{ pwd.stdout }}/:/opt/gondul" ]
      links: [ "gondul-db-test:db", "gondul-graphite-test:graphite" ]
      ports: []
